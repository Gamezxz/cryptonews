(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18614,e=>{"use strict";var s=e.i(43476),t=e.i(71645);function c(){let[e,c]=(0,t.useState)(!1),[a,n]=(0,t.useState)([]),[i,l]=(0,t.useState)(""),[r,o]=(0,t.useState)(!1),h=(0,t.useRef)(null),d=(0,t.useRef)(null);async function u(){let e=i.trim();if(!e||r)return;let s={role:"user",content:e};n(e=>[...e,s]),l(""),o(!0);try{let s=a.slice(-6),t=await fetch(`${window.location.origin}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,history:s})}),c=await t.json();c.success?n(e=>[...e,{role:"assistant",content:c.answer,sources:c.sources||[]}]):n(e=>[...e,{role:"assistant",content:c.error||"เกิดข้อผิดพลาด กรุณาลองใหม่"}])}catch{n(e=>[...e,{role:"assistant",content:"ไม่สามารถเชื่อมต่อ AI ได้ กรุณาลองใหม่"}])}finally{o(!1)}}return(0,t.useEffect)(()=>{h.current&&h.current.scrollIntoView({behavior:"smooth"})},[a,r]),(0,t.useEffect)(()=>{e&&d.current&&d.current.focus()},[e]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{className:"chat-fab",onClick:()=>c(!e),"aria-label":e?"Close chat":"Open AI chat",children:e?"✕":"AI"}),e&&(0,s.jsxs)("div",{className:"chat-window",children:[(0,s.jsxs)("div",{className:"chat-header",children:[(0,s.jsx)("span",{className:"chat-header-icon",children:"AI"}),(0,s.jsx)("span",{children:"CRYPTO NEWS AI"}),(0,s.jsx)("button",{className:"chat-close",onClick:()=>c(!1),children:"✕"})]}),(0,s.jsxs)("div",{className:"chat-messages",children:[0===a.length&&(0,s.jsxs)("div",{className:"chat-welcome",children:[(0,s.jsx)("p",{children:"สวัสดีครับ! ผมเป็น AI ผู้ช่วยวิเคราะห์ข่าว Crypto"}),(0,s.jsx)("p",{children:"ถามอะไรก็ได้เกี่ยวกับข่าว crypto ล่าสุด เช่น:"}),(0,s.jsxs)("div",{className:"chat-suggestions",children:[(0,s.jsx)("button",{onClick:()=>{l("Bitcoin ตอนนี้เป็นยังไงบ้าง?")},children:"Bitcoin ตอนนี้เป็นยังไง?"}),(0,s.jsx)("button",{onClick:()=>{l("สรุปข่าว Ethereum ล่าสุด")},children:"สรุปข่าว Ethereum ล่าสุด"}),(0,s.jsx)("button",{onClick:()=>{l("What are the trending topics today?")},children:"Trending topics today?"})]})]}),a.map((e,t)=>(0,s.jsxs)("div",{className:`chat-msg chat-msg-${e.role}`,children:[(0,s.jsx)("div",{className:"chat-bubble",children:e.content}),e.sources&&e.sources.length>0&&(0,s.jsx)("div",{className:"chat-sources",children:e.sources.map((e,t)=>(0,s.jsx)("a",{href:`/news/${e.slug}`,className:"chat-source-chip",children:e.source},t))})]},t)),r&&(0,s.jsx)("div",{className:"chat-msg chat-msg-assistant",children:(0,s.jsxs)("div",{className:"chat-bubble chat-typing",children:[(0,s.jsx)("span",{}),(0,s.jsx)("span",{}),(0,s.jsx)("span",{})]})}),(0,s.jsx)("div",{ref:h})]}),(0,s.jsxs)("div",{className:"chat-input-area",children:[(0,s.jsx)("input",{ref:d,type:"text",className:"chat-input",placeholder:"ถามเกี่ยวกับข่าว crypto...",value:i,onChange:e=>l(e.target.value.slice(0,500)),onKeyDown:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),u())},disabled:r}),(0,s.jsx)("button",{className:"chat-send",onClick:u,disabled:r||!i.trim(),children:"›"})]})]})]})}e.s(["default",()=>c])}]);