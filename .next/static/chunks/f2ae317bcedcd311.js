(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,77844,e=>{"use strict";var t=e.i(47167),l=e.i(43476),i=e.i(71645),n=e.i(96085);let r=t.default.env.NEXT_PUBLIC_API_URL||"http://localhost:13002";function o(e){return e?new Date(e).toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"}let s={fetch:{icon:"RSS",color:"#3b82f6"},translate:{icon:"TH",color:"#f59e0b"},scrape:{icon:"AI",color:"#a855f7"},rebuild:{icon:"BLD",color:"#22c55e"},admin:{icon:"ADM",color:"#ec4899"},error:{icon:"ERR",color:"#ef4444"}};function a(){let[e,t]=(0,i.useState)(!1),[a,h]=(0,i.useState)(""),[f,x]=(0,i.useState)(""),[u,m]=(0,i.useState)(!1),[y,b]=(0,i.useState)(null),[j,S]=(0,i.useState)([]),[v,C]=(0,i.useState)(""),[T,R]=(0,i.useState)([]),A=(0,i.useRef)(null),B=(0,i.useRef)(null),I=(0,i.useCallback)(e=>{let l=(0,n.io)(r,{path:"/socket.io",transports:["websocket","polling"]});return A.current=l,l.on("connect",()=>{m(!0),l.emit("auth",e)}),l.on("disconnect",()=>m(!1)),l.on("auth_success",()=>{t(!0),x(""),sessionStorage.setItem("admin_key",e)}),l.on("auth_error",e=>{x(e),t(!1),sessionStorage.removeItem("admin_key")}),l.on("stats",e=>{b(e),e.activityLog&&S(e.activityLog)}),l.on("activity",e=>{S(t=>[e,...t].slice(0,30))}),l.on("action_ack",e=>{("done"===e.status||"error"===e.status)&&C("")}),l.on("translate_log",e=>{let t={time:new Date().toISOString(),...e};R(e=>[...e,t].slice(-200))}),l},[]);function E(e){A.current&&!v&&(C(e),A.current.emit("action",e))}return(0,i.useEffect)(()=>{B.current&&(B.current.scrollTop=B.current.scrollHeight)},[T]),(0,i.useEffect)(()=>{let e=sessionStorage.getItem("admin_key");return e&&(h(e),I(e)),()=>{A.current&&A.current.disconnect()}},[I]),e?(0,l.jsxs)("div",{style:p.container,children:[(0,l.jsxs)("header",{style:p.header,children:[(0,l.jsxs)("div",{style:p.headerLeft,children:[(0,l.jsx)("span",{style:p.headerLogo,children:"C"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{style:p.headerTitle,children:"ADMIN DASHBOARD"}),(0,l.jsxs)("p",{style:p.headerSub,children:[u?(0,l.jsx)("span",{style:{color:"#22c55e"},children:"CONNECTED"}):(0,l.jsx)("span",{style:{color:"#ef4444"},children:"DISCONNECTED"}),y&&(0,l.jsxs)("span",{style:{color:"#52525b"},children:[" ","| Updated ",o(y.timestamp)]})]})]})]}),(0,l.jsxs)("div",{style:p.headerRight,children:[(0,l.jsx)("button",{onClick:()=>E("refresh"),disabled:!!v,style:{...p.actionBtn,borderColor:"#3b82f6",color:"#3b82f6"},children:"refresh"===v?"...":"FORCE REFRESH"}),(0,l.jsx)("button",{onClick:()=>E("rebuild"),disabled:!!v,style:{...p.actionBtn,borderColor:"#22c55e",color:"#22c55e"},children:"rebuild"===v?"...":"FORCE REBUILD"}),(0,l.jsx)("button",{onClick:()=>E("translate"),disabled:!!v,style:{...p.actionBtn,borderColor:"#a855f7",color:"#a855f7"},children:"translate"===v?"...":"FORCE TRANSLATE"}),(0,l.jsx)("button",{onClick:()=>E("recreate-cache"),disabled:!!v,style:{...p.actionBtn,borderColor:"#f59e0b",color:"#f59e0b"},children:"recreate-cache"===v?"...":"RECREATE CACHE"}),(0,l.jsx)("button",{onClick:function(){sessionStorage.removeItem("admin_key"),A.current&&A.current.disconnect(),t(!1),b(null),S([])},style:{...p.actionBtn,borderColor:"#ef4444",color:"#ef4444"},children:"LOGOUT"})]})]}),y?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{style:p.cardRow,children:[(0,l.jsx)(c,{label:"TOTAL ARTICLES",value:y.overview.totalArticles,color:"#f59e0b"}),(0,l.jsx)(c,{label:"TODAY",value:y.overview.todayArticles,color:"#22c55e"}),(0,l.jsx)(c,{label:"SOURCES",value:y.overview.sourcesCount,color:"#3b82f6"}),(0,l.jsx)(c,{label:"SCRAPE RATE",value:`${y.scraping.successRate}%`,color:"#a855f7"})]}),(0,l.jsxs)("div",{style:p.cardRow,children:[(0,l.jsx)(d,{title:"SCRAPING PROGRESS",items:[{label:"Scraped",value:y.scraping.scraped,color:"#22c55e"},{label:"Pending",value:y.scraping.pending,color:"#f59e0b"},{label:"Failed",value:y.scraping.failed,color:"#ef4444"}],total:y.scraping.scraped+y.scraping.pending+y.scraping.failed}),(0,l.jsx)(d,{title:"TRANSLATION PROGRESS",items:[{label:"Translated",value:y.translation.translated,color:"#3b82f6"},{label:"Pending",value:y.translation.untranslated,color:"#f59e0b"}],total:y.translation.translated+y.translation.untranslated})]}),(0,l.jsxs)("div",{style:{...p.card,marginBottom:12},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,l.jsx)("h3",{style:{...p.cardTitle,margin:0},children:"TRANSLATION TERMINAL"}),(0,l.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:["translate"===v&&(0,l.jsx)("span",{style:{fontSize:10,color:"#a855f7",letterSpacing:"0.1em"},children:"TRANSLATING..."}),(0,l.jsx)("button",{onClick:()=>R([]),style:{...p.actionBtn,padding:"4px 10px",fontSize:9,borderColor:"#52525b",color:"#52525b"},children:"CLEAR"})]})]}),(0,l.jsx)("div",{ref:B,style:{backgroundColor:"#050506",border:"1px solid #1f1f23",padding:12,height:300,overflowY:"auto",fontFamily:"'JetBrains Mono', monospace",fontSize:11,lineHeight:1.6},children:0===T.length?(0,l.jsx)("p",{style:{color:"#52525b",margin:0},children:"Waiting for translation events... Press FORCE TRANSLATE to start."}):T.map((e,t)=>(0,l.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,l.jsx)("span",{style:{color:"#52525b",flexShrink:0},children:o(e.time)}),(0,l.jsx)("span",{style:{color:"error"===e.status?"#ef4444":"ok"===e.status?"#22c55e":"done"===e.status?"#a855f7":"#a1a1aa"},children:e.message})]},t))})]}),(0,l.jsxs)("div",{style:p.cardRow3,children:[(0,l.jsxs)("div",{style:p.card,children:[(0,l.jsx)("h3",{style:p.cardTitle,children:"SENTIMENT"}),(0,l.jsxs)("div",{style:p.sentimentGrid,children:[(0,l.jsx)(g,{label:"BULLISH",value:y.sentiment.bullish||0,color:"#22c55e",total:y.overview.totalArticles}),(0,l.jsx)(g,{label:"BEARISH",value:y.sentiment.bearish||0,color:"#ef4444",total:y.overview.totalArticles}),(0,l.jsx)(g,{label:"NEUTRAL",value:y.sentiment.neutral||0,color:"#52525b",total:y.overview.totalArticles})]})]}),(0,l.jsxs)("div",{style:p.card,children:[(0,l.jsx)("h3",{style:p.cardTitle,children:"CATEGORIES"}),(0,l.jsx)("div",{style:p.listContainer,children:Object.entries(y.categories).sort((e,t)=>t[1]-e[1]).map(([e,t])=>(0,l.jsxs)("div",{style:p.listItem,children:[(0,l.jsx)("span",{style:p.listLabel,children:e.toUpperCase()}),(0,l.jsx)("span",{style:p.listValue,children:t})]},e))})]}),(0,l.jsxs)("div",{style:p.card,children:[(0,l.jsx)("h3",{style:p.cardTitle,children:"TOP SOURCES"}),(0,l.jsx)("div",{style:p.listContainer,children:Object.entries(y.sources).slice(0,10).map(([e,t])=>(0,l.jsxs)("div",{style:p.listItem,children:[(0,l.jsx)("span",{style:p.listLabel,children:e}),(0,l.jsx)("span",{style:p.listValue,children:t})]},e))})]})]}),(0,l.jsxs)("div",{style:p.cardRow,children:[(0,l.jsxs)("div",{style:{...p.card,flex:2},children:[(0,l.jsx)("h3",{style:p.cardTitle,children:"ACTIVITY LOG"}),(0,l.jsx)("div",{style:p.logContainer,children:0===j.length?(0,l.jsx)("p",{style:{color:"#52525b",fontSize:12},children:"No recent activity"}):j.map((e,t)=>{let i=s[e.type]||s.error;return(0,l.jsxs)("div",{style:p.logEntry,children:[(0,l.jsx)("span",{style:{...p.logBadge,backgroundColor:i.color+"20",color:i.color,borderColor:i.color+"40"},children:i.icon}),(0,l.jsx)("span",{style:p.logMessage,children:e.message}),e.detail&&(0,l.jsx)("span",{style:p.logDetail,children:e.detail}),(0,l.jsx)("span",{style:p.logTime,children:o(e.time)})]},t)})})]}),(0,l.jsxs)("div",{style:{...p.card,flex:1},children:[(0,l.jsx)("h3",{style:p.cardTitle,children:"RECENT ARTICLES"}),(0,l.jsx)("div",{style:p.listContainer,children:y.recentArticles?.map(e=>(0,l.jsxs)("div",{style:p.recentItem,children:[(0,l.jsxs)("div",{style:p.recentTitle,children:[e.title?.substring(0,50),"..."]}),(0,l.jsxs)("div",{style:p.recentMeta,children:[(0,l.jsx)("span",{children:e.source}),(0,l.jsx)("span",{style:{color:"scraped"===e.scrapingStatus?"#22c55e":"failed"===e.scrapingStatus?"#ef4444":"#f59e0b"},children:e.scrapingStatus||"pending"}),(0,l.jsx)("span",{children:function(e){if(!e)return"";let t=Math.floor((Date.now()-new Date(e).getTime())/1e3);if(t<60)return`${t}s ago`;let l=Math.floor(t/60);if(l<60)return`${l}m ago`;let i=Math.floor(l/60);return`${i}h ago`}(e.createdAt)})]})]},e._id))})]})]})]}):(0,l.jsx)("div",{style:p.loading,children:"Loading stats..."})]}):(0,l.jsx)("div",{style:p.loginContainer,children:(0,l.jsxs)("div",{style:p.loginBox,children:[(0,l.jsx)("div",{style:p.loginLogo,children:"C"}),(0,l.jsx)("h1",{style:p.loginTitle,children:"ADMIN DASHBOARD"}),(0,l.jsx)("p",{style:p.loginSubtitle,children:"Crypto Intelligence Monitor"}),(0,l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a.trim()&&(A.current&&A.current.disconnect(),I(a.trim()))},children:[(0,l.jsx)("input",{type:"password",value:a,onChange:e=>h(e.target.value),placeholder:"Enter admin key...",style:p.loginInput,autoFocus:!0}),(0,l.jsx)("button",{type:"submit",style:p.loginButton,children:"AUTHENTICATE"})]}),f&&(0,l.jsx)("p",{style:p.errorText,children:f})]})})}function c({label:e,value:t,color:i}){return(0,l.jsxs)("div",{style:{...p.card,...p.statCard},children:[(0,l.jsx)("p",{style:p.statLabel,children:e}),(0,l.jsx)("p",{style:{...p.statValue,color:i},children:t})]})}function d({title:e,items:t,total:i}){return(0,l.jsxs)("div",{style:{...p.card,flex:1},children:[(0,l.jsx)("h3",{style:p.cardTitle,children:e}),(0,l.jsx)("div",{style:p.progressBarBg,children:t.map((e,t)=>(0,l.jsx)("div",{style:{height:"100%",width:i>0?`${e.value/i*100}%`:"0%",backgroundColor:e.color,transition:"width 0.5s ease"}},t))}),(0,l.jsx)("div",{style:p.progressLabels,children:t.map((e,t)=>(0,l.jsxs)("div",{style:p.progressItem,children:[(0,l.jsx)("span",{style:{...p.dot,backgroundColor:e.color}}),(0,l.jsxs)("span",{style:p.progressText,children:[e.label,": ",(0,l.jsx)("strong",{children:e.value})]})]},t))})]})}function g({label:e,value:t,color:i,total:n}){let r=n>0?(t/n*100).toFixed(1):0;return(0,l.jsxs)("div",{style:{marginBottom:10},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[(0,l.jsx)("span",{style:{fontSize:11,color:"#a1a1aa",letterSpacing:"0.1em"},children:e}),(0,l.jsxs)("span",{style:{fontSize:12,color:i,fontWeight:700},children:[t," (",r,"%)"]})]}),(0,l.jsx)("div",{style:{...p.progressBarBg,height:6},children:(0,l.jsx)("div",{style:{height:"100%",width:`${r}%`,backgroundColor:i,transition:"width 0.5s ease"}})})]})}let p={loginContainer:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#0a0a0b",fontFamily:"'JetBrains Mono', monospace"},loginBox:{textAlign:"center",padding:40,border:"1px solid #27272b",backgroundColor:"#111113",maxWidth:400,width:"100%"},loginLogo:{width:48,height:48,border:"2px solid #f59e0b",color:"#f59e0b",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:20,fontWeight:800,marginBottom:16},loginTitle:{fontSize:16,fontWeight:700,color:"#fafafa",letterSpacing:"0.15em",margin:"0 0 4px"},loginSubtitle:{fontSize:11,color:"#52525b",letterSpacing:"0.1em",margin:"0 0 24px"},loginInput:{width:"100%",padding:"12px 16px",backgroundColor:"#0a0a0b",border:"1px solid #27272b",color:"#fafafa",fontSize:14,fontFamily:"'JetBrains Mono', monospace",outline:"none",marginBottom:12,boxSizing:"border-box"},loginButton:{width:"100%",padding:"12px 16px",backgroundColor:"#f59e0b",border:"none",color:"#0a0a0b",fontSize:12,fontWeight:700,letterSpacing:"0.15em",cursor:"pointer",fontFamily:"'JetBrains Mono', monospace"},errorText:{color:"#ef4444",fontSize:12,marginTop:12},container:{minHeight:"100vh",backgroundColor:"#0a0a0b",color:"#fafafa",fontFamily:"'JetBrains Mono', monospace",padding:"0 24px 48px"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px 0",borderBottom:"1px solid #1f1f23",marginBottom:24,flexWrap:"wrap",gap:12},headerLeft:{display:"flex",alignItems:"center",gap:12},headerLogo:{width:36,height:36,border:"2px solid #f59e0b",color:"#f59e0b",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:16,fontWeight:800},headerTitle:{fontSize:14,fontWeight:700,letterSpacing:"0.15em",margin:0},headerSub:{fontSize:11,margin:0,letterSpacing:"0.05em"},headerRight:{display:"flex",gap:8,flexWrap:"wrap"},actionBtn:{padding:"8px 16px",backgroundColor:"transparent",border:"1px solid",fontSize:10,fontWeight:700,letterSpacing:"0.1em",cursor:"pointer",fontFamily:"'JetBrains Mono', monospace",transition:"all 0.15s ease"},loading:{textAlign:"center",padding:60,color:"#52525b",fontSize:14,letterSpacing:"0.1em"},cardRow:{display:"flex",gap:12,marginBottom:12,flexWrap:"wrap"},cardRow3:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:12},card:{backgroundColor:"#111113",border:"1px solid #1f1f23",padding:20,flex:1,minWidth:200},cardTitle:{fontSize:10,fontWeight:700,color:"#52525b",letterSpacing:"0.15em",margin:"0 0 16px",textTransform:"uppercase"},statCard:{textAlign:"center",minWidth:140},statLabel:{fontSize:10,color:"#52525b",letterSpacing:"0.15em",margin:"0 0 8px"},statValue:{fontSize:28,fontWeight:800,margin:0},progressBarBg:{display:"flex",height:8,backgroundColor:"#1f1f23",overflow:"hidden",marginBottom:12},progressLabels:{display:"flex",gap:16,flexWrap:"wrap"},progressItem:{display:"flex",alignItems:"center",gap:6},dot:{width:8,height:8,display:"inline-block"},progressText:{fontSize:11,color:"#a1a1aa"},sentimentGrid:{display:"flex",flexDirection:"column"},listContainer:{display:"flex",flexDirection:"column",gap:6,maxHeight:300,overflowY:"auto"},listItem:{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid #1f1f2310",fontSize:12},listLabel:{color:"#a1a1aa"},listValue:{color:"#fafafa",fontWeight:700},logContainer:{display:"flex",flexDirection:"column",gap:6,maxHeight:400,overflowY:"auto"},logEntry:{display:"flex",alignItems:"center",gap:8,padding:"6px 0",borderBottom:"1px solid #1f1f2320",fontSize:12},logBadge:{padding:"2px 6px",fontSize:9,fontWeight:700,letterSpacing:"0.05em",border:"1px solid",flexShrink:0},logMessage:{color:"#a1a1aa",flex:1},logDetail:{color:"#52525b",fontSize:11,flexShrink:0},logTime:{color:"#52525b",fontSize:10,flexShrink:0,minWidth:70,textAlign:"right"},recentItem:{padding:"8px 0",borderBottom:"1px solid #1f1f2320"},recentTitle:{fontSize:12,color:"#fafafa",marginBottom:4,lineHeight:1.4},recentMeta:{display:"flex",gap:8,fontSize:10,color:"#52525b"}};e.s(["default",()=>a])}]);